{"version":3,"names":["React","useMemo","useState","StyleSheet","Animated","runOnJS","useAnimatedReaction","useAnimatedStyle","useAnimatedValues","useDraggableFlatListContext","useRefs","typedMemo","PlaceholderItem","renderPlaceholder","size","setSize","activeCellSize","placeholderOffset","spacerIndexAnim","horizontalAnim","scrollOffset","keyToIndexRef","propsRef","activeKey","horizontal","value","cur","prev","activeIndex","current","get","undefined","activeItem","data","animStyle","offset","opacity","overflow","transform","translateX","translateY","extraStyle","width","height","absoluteFill","item","index"],"sources":["PlaceholderItem.tsx"],"sourcesContent":["import React, { useMemo, useState } from \"react\";\r\nimport { StyleSheet } from \"react-native\";\r\nimport Animated, {\r\n  runOnJS,\r\n  useAnimatedReaction,\r\n  useAnimatedStyle,\r\n} from \"react-native-reanimated\";\r\nimport { useAnimatedValues } from \"../context/animatedValueContext\";\r\nimport { useDraggableFlatListContext } from \"../context/draggableFlatListContext\";\r\nimport { useRefs } from \"../context/refContext\";\r\nimport { RenderPlaceholder } from \"../types\";\r\nimport { typedMemo } from \"../utils\";\r\n\r\ntype Props<T> = {\r\n  renderPlaceholder?: RenderPlaceholder<T>;\r\n};\r\n\r\nfunction PlaceholderItem<T>({ renderPlaceholder }: Props<T>) {\r\n  const [size, setSize] = useState(0);\r\n  const {\r\n    activeCellSize,\r\n    placeholderOffset,\r\n    spacerIndexAnim,\r\n    horizontalAnim,\r\n    scrollOffset,\r\n  } = useAnimatedValues();\r\n  const { keyToIndexRef, propsRef } = useRefs<T>();\r\n  const { activeKey, horizontal } = useDraggableFlatListContext();\r\n\r\n  // Size does not seem to be respected when it is an animated style\r\n  useAnimatedReaction(\r\n    () => {\r\n      return activeCellSize.value;\r\n    },\r\n    (cur, prev) => {\r\n      if (cur !== prev) {\r\n        runOnJS(setSize)(cur);\r\n      }\r\n    }\r\n  );\r\n\r\n  const activeIndex = activeKey\r\n    ? keyToIndexRef.current.get(activeKey)\r\n    : undefined;\r\n  const activeItem =\r\n    activeIndex === undefined ? null : propsRef.current?.data[activeIndex];\r\n\r\n  const animStyle = useAnimatedStyle(() => {\r\n    const offset = placeholderOffset.value - scrollOffset.value\r\n    return {\r\n        opacity: size >= 0 ? 1 : 0,\r\n        overflow: 'hidden',\r\n        transform: [\r\n          horizontalAnim.value\r\n            ? { translateX: offset }\r\n            : { translateY: offset },\r\n        ],\r\n      };\r\n\r\n  }, [spacerIndexAnim, placeholderOffset, horizontalAnim, scrollOffset, size]);\r\n\r\n  const extraStyle = useMemo(() => {\r\n    return horizontal ? { width: size } : { height: size };\r\n  }, [horizontal, size])\r\n\r\n  return (\r\n    <Animated.View\r\n      pointerEvents={activeKey ? \"auto\" : \"none\"}\r\n      style={[StyleSheet.absoluteFill, animStyle, extraStyle]}\r\n    >\r\n      {!activeItem || activeIndex === undefined\r\n        ? null\r\n        : renderPlaceholder?.({ item: activeItem, index: activeIndex })}\r\n    </Animated.View>\r\n  );\r\n}\r\n\r\nexport default typedMemo(PlaceholderItem);\r\n"],"mappings":"AAAA,OAAOA,KAAP,IAAgBC,OAAhB,EAAyBC,QAAzB,QAAyC,OAAzC;AACA,SAASC,UAAT,QAA2B,cAA3B;AACA,OAAOC,QAAP,IACEC,OADF,EAEEC,mBAFF,EAGEC,gBAHF,QAIO,yBAJP;AAKA,SAASC,iBAAT,QAAkC,iCAAlC;AACA,SAASC,2BAAT,QAA4C,qCAA5C;AACA,SAASC,OAAT,QAAwB,uBAAxB;AAEA,SAASC,SAAT,QAA0B,UAA1B;;AAMA,SAASC,eAAT,OAA6D;EAAA;;EAAA,IAAjC;IAAEC;EAAF,CAAiC;EAC3D,MAAM,CAACC,IAAD,EAAOC,OAAP,IAAkBb,QAAQ,CAAC,CAAD,CAAhC;EACA,MAAM;IACJc,cADI;IAEJC,iBAFI;IAGJC,eAHI;IAIJC,cAJI;IAKJC;EALI,IAMFZ,iBAAiB,EANrB;EAOA,MAAM;IAAEa,aAAF;IAAiBC;EAAjB,IAA8BZ,OAAO,EAA3C;EACA,MAAM;IAAEa,SAAF;IAAaC;EAAb,IAA4Bf,2BAA2B,EAA7D,CAV2D,CAY3D;;EACAH,mBAAmB,CACjB,MAAM;IACJ,OAAOU,cAAc,CAACS,KAAtB;EACD,CAHgB,EAIjB,CAACC,GAAD,EAAMC,IAAN,KAAe;IACb,IAAID,GAAG,KAAKC,IAAZ,EAAkB;MAChBtB,OAAO,CAACU,OAAD,CAAP,CAAiBW,GAAjB;IACD;EACF,CARgB,CAAnB;EAWA,MAAME,WAAW,GAAGL,SAAS,GACzBF,aAAa,CAACQ,OAAd,CAAsBC,GAAtB,CAA0BP,SAA1B,CADyB,GAEzBQ,SAFJ;EAGA,MAAMC,UAAU,GACdJ,WAAW,KAAKG,SAAhB,GAA4B,IAA5B,wBAAmCT,QAAQ,CAACO,OAA5C,sDAAmC,kBAAkBI,IAAlB,CAAuBL,WAAvB,CADrC;EAGA,MAAMM,SAAS,GAAG3B,gBAAgB,CAAC,MAAM;IACvC,MAAM4B,MAAM,GAAGlB,iBAAiB,CAACQ,KAAlB,GAA0BL,YAAY,CAACK,KAAtD;IACA,OAAO;MACHW,OAAO,EAAEtB,IAAI,IAAI,CAAR,GAAY,CAAZ,GAAgB,CADtB;MAEHuB,QAAQ,EAAE,QAFP;MAGHC,SAAS,EAAE,CACTnB,cAAc,CAACM,KAAf,GACI;QAAEc,UAAU,EAAEJ;MAAd,CADJ,GAEI;QAAEK,UAAU,EAAEL;MAAd,CAHK;IAHR,CAAP;EAUD,CAZiC,EAY/B,CAACjB,eAAD,EAAkBD,iBAAlB,EAAqCE,cAArC,EAAqDC,YAArD,EAAmEN,IAAnE,CAZ+B,CAAlC;EAcA,MAAM2B,UAAU,GAAGxC,OAAO,CAAC,MAAM;IAC/B,OAAOuB,UAAU,GAAG;MAAEkB,KAAK,EAAE5B;IAAT,CAAH,GAAqB;MAAE6B,MAAM,EAAE7B;IAAV,CAAtC;EACD,CAFyB,EAEvB,CAACU,UAAD,EAAaV,IAAb,CAFuB,CAA1B;EAIA,oBACE,oBAAC,QAAD,CAAU,IAAV;IACE,aAAa,EAAES,SAAS,GAAG,MAAH,GAAY,MADtC;IAEE,KAAK,EAAE,CAACpB,UAAU,CAACyC,YAAZ,EAA0BV,SAA1B,EAAqCO,UAArC;EAFT,GAIG,CAACT,UAAD,IAAeJ,WAAW,KAAKG,SAA/B,GACG,IADH,GAEGlB,iBAFH,aAEGA,iBAFH,uBAEGA,iBAAiB,CAAG;IAAEgC,IAAI,EAAEb,UAAR;IAAoBc,KAAK,EAAElB;EAA3B,CAAH,CANvB,CADF;AAUD;;AAED,eAAejB,SAAS,CAACC,eAAD,CAAxB"}