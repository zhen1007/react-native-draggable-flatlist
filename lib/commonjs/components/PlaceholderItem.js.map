{"version":3,"names":["PlaceholderItem","renderPlaceholder","useState","size","setSize","useAnimatedValues","activeCellSize","placeholderOffset","spacerIndexAnim","horizontalAnim","scrollOffset","useRefs","keyToIndexRef","propsRef","useDraggableFlatListContext","activeKey","horizontal","useAnimatedReaction","value","cur","prev","runOnJS","activeIndex","current","get","undefined","activeItem","data","animStyle","useAnimatedStyle","offset","opacity","overflow","transform","translateX","translateY","extraStyle","useMemo","width","height","StyleSheet","absoluteFill","item","index","typedMemo"],"sources":["PlaceholderItem.tsx"],"sourcesContent":["import React, { useMemo, useState } from \"react\";\r\nimport { StyleSheet } from \"react-native\";\r\nimport Animated, {\r\n  runOnJS,\r\n  useAnimatedReaction,\r\n  useAnimatedStyle,\r\n} from \"react-native-reanimated\";\r\nimport { useAnimatedValues } from \"../context/animatedValueContext\";\r\nimport { useDraggableFlatListContext } from \"../context/draggableFlatListContext\";\r\nimport { useRefs } from \"../context/refContext\";\r\nimport { RenderPlaceholder } from \"../types\";\r\nimport { typedMemo } from \"../utils\";\r\n\r\ntype Props<T> = {\r\n  renderPlaceholder?: RenderPlaceholder<T>;\r\n};\r\n\r\nfunction PlaceholderItem<T>({ renderPlaceholder }: Props<T>) {\r\n  const [size, setSize] = useState(0);\r\n  const {\r\n    activeCellSize,\r\n    placeholderOffset,\r\n    spacerIndexAnim,\r\n    horizontalAnim,\r\n    scrollOffset,\r\n  } = useAnimatedValues();\r\n  const { keyToIndexRef, propsRef } = useRefs<T>();\r\n  const { activeKey, horizontal } = useDraggableFlatListContext();\r\n\r\n  // Size does not seem to be respected when it is an animated style\r\n  useAnimatedReaction(\r\n    () => {\r\n      return activeCellSize.value;\r\n    },\r\n    (cur, prev) => {\r\n      if (cur !== prev) {\r\n        runOnJS(setSize)(cur);\r\n      }\r\n    }\r\n  );\r\n\r\n  const activeIndex = activeKey\r\n    ? keyToIndexRef.current.get(activeKey)\r\n    : undefined;\r\n  const activeItem =\r\n    activeIndex === undefined ? null : propsRef.current?.data[activeIndex];\r\n\r\n  const animStyle = useAnimatedStyle(() => {\r\n    const offset = placeholderOffset.value - scrollOffset.value\r\n    return {\r\n        opacity: size >= 0 ? 1 : 0,\r\n        overflow: 'hidden',\r\n        transform: [\r\n          horizontalAnim.value\r\n            ? { translateX: offset }\r\n            : { translateY: offset },\r\n        ],\r\n      };\r\n\r\n  }, [spacerIndexAnim, placeholderOffset, horizontalAnim, scrollOffset, size]);\r\n\r\n  const extraStyle = useMemo(() => {\r\n    return horizontal ? { width: size } : { height: size };\r\n  }, [horizontal, size])\r\n\r\n  return (\r\n    <Animated.View\r\n      pointerEvents={activeKey ? \"auto\" : \"none\"}\r\n      style={[StyleSheet.absoluteFill, animStyle, extraStyle]}\r\n    >\r\n      {!activeItem || activeIndex === undefined\r\n        ? null\r\n        : renderPlaceholder?.({ item: activeItem, index: activeIndex })}\r\n    </Animated.View>\r\n  );\r\n}\r\n\r\nexport default typedMemo(PlaceholderItem);\r\n"],"mappings":"+PAAA,qDACA,yCACA,uFAKA,qEACA,6EACA,iDAEA,+B,6lCAMA,QAASA,gBAAT,MAA6D,0BAA/BC,kBAA+B,MAA/BA,iBAA+B,eACnC,GAAAC,eAAA,EAAS,CAAT,CADmC,qDACpDC,IADoD,eAC9CC,OAD8C,sCAQvD,GAAAC,uCAAA,GARuD,CAGzDC,cAHyD,oBAGzDA,cAHyD,CAIzDC,iBAJyD,oBAIzDA,iBAJyD,CAKzDC,eALyD,oBAKzDA,eALyD,CAMzDC,cANyD,oBAMzDA,cANyD,CAOzDC,YAPyD,oBAOzDA,YAPyD,cASvB,GAAAC,mBAAA,GATuB,CASnDC,aATmD,UASnDA,aATmD,CASpCC,QAToC,UASpCA,QAToC,2BAUzB,GAAAC,qDAAA,GAVyB,CAUnDC,SAVmD,uBAUnDA,SAVmD,CAUxCC,UAVwC,uBAUxCA,UAVwC,CAa3D,GAAAC,0CAAA,iCACQ,CACJ,MAAOX,eAAc,CAACY,KAAtB,CACD,CAHH,6BA5BOZ,cA4BP,sRAIGa,GAJH,CAIQC,IAJR,CAIiB,CACb,GAAID,GAAG,GAAKC,IAAZ,CAAkB,CAChB,GAAAC,8BAAA,EAAQjB,OAAR,EAAiBe,GAAjB,EACD,CACF,CARH,sBA3BEE,8BA2BF,SA3BUjB,OA2BV,4QAWA,GAAMkB,YAAW,CAAGP,SAAS,CACzBH,aAAa,CAACW,OAAd,CAAsBC,GAAtB,CAA0BT,SAA1B,CADyB,CAEzBU,SAFJ,CAGA,GAAMC,WAAU,CACdJ,WAAW,GAAKG,SAAhB,CAA4B,IAA5B,oBAAmCZ,QAAQ,CAACU,OAA5C,eAAmC,kBAAkBI,IAAlB,CAAuBL,WAAvB,CADrC,CAGA,GAAMM,UAAS,CAAG,GAAAC,uCAAA,iCAAuB,CACvC,GAAMC,OAAM,CAAGvB,iBAAiB,CAACW,KAAlB,CAA0BR,YAAY,CAACQ,KAAtD,CACA,MAAO,CACHa,OAAO,CAAE5B,IAAI,EAAI,CAAR,CAAY,CAAZ,CAAgB,CADtB,CAEH6B,QAAQ,CAAE,QAFP,CAGHC,SAAS,CAAE,CACTxB,cAAc,CAACS,KAAf,CACI,CAAEgB,UAAU,CAAEJ,MAAd,CADJ,CAEI,CAAEK,UAAU,CAAEL,MAAd,CAHK,CAHR,CAAP,CAUD,CAZiB,gCA7CHvB,iBA6CG,cA7CuBG,YA6CvB,MA3CPP,IA2CO,gBAzCJM,cAyCI,ucAYf,CAACD,eAAD,CAAkBD,iBAAlB,CAAqCE,cAArC,CAAqDC,YAArD,CAAmEP,IAAnE,CAZe,CAAlB,CAcA,GAAMiC,WAAU,CAAG,GAAAC,cAAA,EAAQ,UAAM,CAC/B,MAAOrB,WAAU,CAAG,CAAEsB,KAAK,CAAEnC,IAAT,CAAH,CAAqB,CAAEoC,MAAM,CAAEpC,IAAV,CAAtC,CACD,CAFkB,CAEhB,CAACa,UAAD,CAAab,IAAb,CAFgB,CAAnB,CAIA,MACE,8BAAC,8BAAD,CAAU,IAAV,EACE,aAAa,CAAEY,SAAS,CAAG,MAAH,CAAY,MADtC,CAEE,KAAK,CAAE,CAACyB,uBAAA,CAAWC,YAAZ,CAA0Bb,SAA1B,CAAqCQ,UAArC,CAFT,4EAIG,CAACV,UAAD,EAAeJ,WAAW,GAAKG,SAA/B,CACG,IADH,CAEGxB,iBAFH,cAEGA,iBAAiB,CAAG,CAAEyC,IAAI,CAAEhB,UAAR,CAAoBiB,KAAK,CAAErB,WAA3B,CAAH,CANvB,CADF,CAUD,C,aAEc,GAAAsB,gBAAA,EAAU5C,eAAV,C"}